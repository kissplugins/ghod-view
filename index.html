<!DOCTYPE html>
<html>
<head>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
<body>
  <div id="root"></div>
  
  <script type="text/babel">
    function GitHubActivityFeed() {
      const [token, setToken] = React.useState(localStorage.getItem('gh_token') || '');
      const [activity, setActivity] = React.useState([]);
      const [assignedIssues, setAssignedIssues] = React.useState([]);
      
      async function fetchActivity() {
        const headers = { 'Authorization': `token ${token}` };
        
        // Fetch your events
        const response = await fetch('https://api.github.com/users/noelsaw1/events', { headers });
        const events = await response.json();
        
        // Group by day
        const grouped = events.reduce((acc, event) => {
          const day = event.created_at.split('T')[0];
          if (!acc[day]) acc[day] = [];
          acc[day].push(event);
          return acc;
        }, {});
        
        setActivity(grouped);
        
        // Fetch assigned issues
        const issuesResponse = await fetch('https://api.github.com/issues?filter=assigned&state=open&sort=updated&per_page=5', { headers });
        const issues = await issuesResponse.json();
        setAssignedIssues(issues);
      }
      
      // Get unique repos
      const uniqueRepos = [...new Set(
        Object.values(activity).flat().map(e => e.repo.name)
      )].sort();
      
      return (
        <div>
          <div>
            <input 
              type="password" 
              value={token} 
              onChange={(e) => {
                setToken(e.target.value);
                localStorage.setItem('gh_token', e.target.value);
              }}
              placeholder="GitHub Token"
            />
            <button onClick={fetchActivity}>Load Activity</button>
          </div>
          
          {uniqueRepos.length > 0 && (
            <div style={{ padding: '10px', borderBottom: '2px solid #ccc', marginBottom: '20px' }}>
              <strong>Active Repos:</strong>{' '}
              {uniqueRepos.map((repo, i) => (
                <span key={repo}>
                  <a href={`https://github.com/${repo}`} target="_blank" rel="noopener noreferrer">{repo}</a>
                  {i < uniqueRepos.length - 1 && ' | '}
                </span>
              ))}
            </div>
          )}
          
          <div style={{ display: 'flex', gap: '20px' }}>
            <div style={{ flex: '2' }}>
              {Object.entries(activity).map(([day, events]) => {
            const date = new Date(day + 'T00:00:00');
            const formatted = date.toLocaleDateString('en-US', { 
              weekday: 'long', 
              year: 'numeric', 
              month: 'long', 
              day: 'numeric' 
            });
            
            return (
              <div key={day}>
                <h2>{formatted}</h2>
                <ul>
                  {events.map(e => (
                    <li key={e.id}>
                      {e.type} - <a href={`https://github.com/${e.repo.name}`} target="_blank" rel="noopener noreferrer">{e.repo.name}</a>
                    </li>
                  ))}
                </ul>
              </div>
            );
          })}
            </div>
            
            <div style={{ flex: '1', borderLeft: '2px solid #ccc', paddingLeft: '20px' }}>
              <h3>Assigned Issues</h3>
              <ul style={{ listStyle: 'none', padding: 0 }}>
                {assignedIssues.map(issue => (
                  <li key={issue.id} style={{ marginBottom: '15px', paddingBottom: '15px', borderBottom: '1px solid #eee' }}>
                    <a href={issue.html_url} target="_blank" rel="noopener noreferrer" style={{ fontWeight: 'bold' }}>
                      {issue.title}
                    </a>
                    <div style={{ fontSize: '0.9em', color: '#666', marginTop: '5px' }}>
                      {issue.repository_url.split('/').slice(-2).join('/')} â€¢ #{issue.number}
                    </div>
                  </li>
                ))}
              </ul>
            </div>
          </div>
        </div>
      );
    }
    
    ReactDOM.render(<GitHubActivityFeed />, document.getElementById('root'));
  </script>
</body>
</html>